<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_hr_gate_pass_form_inherit_ehs_link" model="ir.ui.view">
        <field name="name">hr.gate.pass.form.ehs.link</field>
        <field name="model">hr.gate.pass</field>
        <field name="inherit_id" ref="hr_gate_pass.hr_gate_pass_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group/field[@name='contractor_visit_type']" position="after">
                <!-- Show only for contractor + work_permit; required only then -->
                <field name="ehs_permit_type"
                       invisible="contractor_visit_type != 'work_permit' or pass_type != 'contractor'"
                       required="pass_type == 'contractor' and contractor_visit_type == 'work_permit'"/>
                <field name="work_heights_permit_id" invisible="1"/>
                <field name="energized_work_permit_id" invisible="1"/>
                <field name="daily_permit_work_id" invisible="1"/>
                <field name="hot_work_permit_id" invisible="1"/>
            </xpath>
            <xpath expr="//header/field[@name='state']" position="before">
                <button name="action_create_work_heights_permit" type="object" string="Create Work at Heights Permit" class="btn-secondary ehs-create-btn ehs-work-heights" invisible="pass_type != 'contractor' or contractor_visit_type != 'work_permit' or ehs_permit_type != 'work_heights' or work_heights_permit_id"/>
                <button name="action_create_energized_work_permit" type="object" string="Create Energized Work Permit" class="btn-secondary ehs-create-btn ehs-energized" invisible="pass_type != 'contractor' or contractor_visit_type != 'work_permit' or ehs_permit_type != 'energized' or energized_work_permit_id"/>
                <button name="action_create_daily_permit_work" type="object" string="Create Daily Work Permit" class="btn-secondary ehs-create-btn ehs-daily" invisible="pass_type != 'contractor' or contractor_visit_type != 'work_permit' or ehs_permit_type != 'daily' or daily_permit_work_id"/>
                <button name="action_create_hot_work_permit" type="object" string="Create Hot Work Permit" class="btn-secondary ehs-create-btn ehs-hot-work" invisible="pass_type != 'contractor' or contractor_visit_type != 'work_permit' or ehs_permit_type != 'hot_work' or hot_work_permit_id"/>
            </xpath>
            <xpath expr="//div[@name='button_box']" position="inside">
                <button type="object" name="action_open_work_heights_permit" class="oe_stat_button ehs-open-btn" icon="fa-external-link" string="Work at Heights Permit" invisible="pass_type != 'contractor' or contractor_visit_type != 'work_permit' or not work_heights_permit_id"/>
                <button type="object" name="action_open_energized_work_permit" class="oe_stat_button ehs-open-btn" icon="fa-bolt" string="Energized Work Permit" invisible="pass_type != 'contractor' or contractor_visit_type != 'work_permit' or not energized_work_permit_id"/>
                <button type="object" name="action_open_daily_permit_work" class="oe_stat_button ehs-open-btn" icon="fa-calendar" string="Daily Work Permit" invisible="pass_type != 'contractor' or contractor_visit_type != 'work_permit' or not daily_permit_work_id"/>
                <button type="object" name="action_open_hot_work_permit" class="oe_stat_button ehs-open-btn" icon="fa-fire" string="Hot Work Permit" invisible="pass_type != 'contractor' or contractor_visit_type != 'work_permit' or not hot_work_permit_id"/>
            </xpath>
        </field>
    </record>
</odoo>
