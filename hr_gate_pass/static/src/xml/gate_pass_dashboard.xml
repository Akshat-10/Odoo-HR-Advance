<!-- static/src/xml/gate_pass_dashboard.xml -->
<templates>
    <t t-name="hr_gate_pass.DashboardTemplate" owl="1">
        <div class="gate_pass_dashboard">
            <!-- Header -->
            <div class="dashboard-header">
                <div class="dashboard-title">
                    <h2>Gate Pass Analytics Dashboard</h2>
                    <button class="btn btn-primary dashboard-refresh" t-on-click="refreshDashboard">
                        <i class="fa fa-refresh"/>
                        Refresh
                    </button>
                </div>
            </div>

            <!-- Loading State -->
            <div t-if="state.loading" class="dashboard-loading">
                <div class="loading-spinner">
                    <i class="fa fa-spinner fa-spin fa-3x"/>
                    <p>Loading dashboard data...</p>
                </div>
            </div>

            <!-- Error State -->
            <div t-if="state.error" class="dashboard-error">
                <div class="alert alert-danger">
                    <i class="fa fa-exclamation-triangle"/>
                    Error: <t t-esc="state.error"/>
                </div>
            </div>

            <!-- Main Dashboard Content -->
            <div t-if="!state.loading and !state.error" class="dashboard-content">

                <!-- KPI Cards Row 1 - Gate Passes -->
                <div class="kpi-row passes-row">
                    <div class="kpi-card total-passes" t-on-click="() => this.onKpiClick('total')">
                        <div class="kpi-icon">
                            <i class="fa fa-id-card-o"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.total_passes"/>
                            <p>Total Passes</p>
                        </div>
                    </div>

                    <div class="kpi-card active-passes" t-on-click="() => this.onKpiClick('active')">
                        <div class="kpi-icon">
                            <i class="fa fa-check-circle"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.active_passes"/>
                            <p>Active Passes</p>
                        </div>
                    </div>

                    <div class="kpi-card pending-passes" t-on-click="() => this.onKpiClick('pending')">
                        <div class="kpi-icon">
                            <i class="fa fa-clock-o"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.pending_approvals"/>
                            <p>Pending Approvals</p>
                        </div>
                    </div>

                    <div class="kpi-card expired-passes" t-on-click="() => this.onKpiClick('expired')">
                        <div class="kpi-icon">
                            <i class="fa fa-times-circle"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.expired_passes"/>
                            <p>Expired Passes</p>
                        </div>
                    </div>

                    <div class="kpi-card recent-passes">
                        <div class="kpi-icon">
                            <i class="fa fa-calendar"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.recent_passes"/>
                            <p>This Week</p>
                        </div>
                    </div>
                </div>

                <!-- KPI Cards Row 2 - Permits -->
                <div class="kpi-row permits-row">
                    <div class="kpi-card total-permits" t-on-click="() => this.onKpiClick('total_permits')">
                        <div class="kpi-icon">
                            <i class="fa fa-certificate"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.total_permits"/>
                            <p>Total Permits</p>
                        </div>
                    </div>

                    <div class="kpi-card hot-work-permits" t-on-click="() => this.onKpiClick('hot_work')">
                        <div class="kpi-icon">
                            <i class="fa fa-fire"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.hot_work_permits"/>
                            <p>Hot Work Permits</p>
                        </div>
                    </div>

                    <div class="kpi-card energized-work-permits" t-on-click="() => this.onKpiClick('energized_work')">
                        <div class="kpi-icon">
                            <i class="fa fa-bolt"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.energized_work_permits"/>
                            <p>Energized Work</p>
                        </div>
                    </div>

                    <div class="kpi-card height-work-permits" t-on-click="() => this.onKpiClick('height_work')">
                        <div class="kpi-icon">
                            <i class="fa fa-arrow-up"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.height_work_permits"/>
                            <p>Height Work</p>
                        </div>
                    </div>

                    <div class="kpi-card daily-work-permits" t-on-click="() => this.onKpiClick('daily_work')">
                        <div class="kpi-icon">
                            <i class="fa fa-calendar-check-o"/>
                        </div>
                        <div class="kpi-content">
                            <h3 t-esc="state.kpis.daily_work_permits"/>
                            <p>Daily Work</p>
                        </div>
                    </div>
                </div>



                <!-- Charts Row 1 - Three Charts -->
                <div class="charts-row three-chart-row">
                    <!-- State Distribution Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h4>Status Distribution</h4>
                        </div>
                        <div class="chart-content">
                            <canvas t-ref="stateChart"/>
                        </div>
                    </div>

                    <!-- Pass Type Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h4>Pass Types</h4>
                        </div>
                        <div class="chart-content">
                            <canvas t-ref="passTypeChart"/>
                        </div>
                    </div>

                    <!-- Department Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h4>Department Wise</h4>
                        </div>
                        <div class="chart-content">
                            <canvas t-ref="deptChart"/>
                        </div>
                    </div>
                </div>

                <!-- Charts Row 2 - 2:1 Format -->
                <div class="charts-row two-one-row">
                    <!-- Monthly Trend Chart (2/3 width) -->
                    <div class="chart-container trend-chart">
                        <div class="chart-header">
                            <h4>Monthly Trend (Last 6 Months)</h4>
                        </div>
                        <div class="chart-content">
                            <canvas t-ref="trendChart"/>
                        </div>
                    </div>

                    <!-- Permit Types Chart (1/3 width) -->
                    <div class="chart-container permit-types-chart">
                        <div class="chart-header">
                            <h4>EHS Permits</h4>
                        </div>
                        <div class="chart-content">
                            <canvas t-ref="permitTypesChart"/>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </t>
</templates>