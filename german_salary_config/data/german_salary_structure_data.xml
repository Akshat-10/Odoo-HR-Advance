<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data noupdate="0">
        <!-- German TMT Salary Structure -->
        <record id="german_tmt_salary_structure" model="salary.config.structure">
            <field name="name">German TMT Salary Structure</field>
            <field name="company_id" ref="base.main_company"/>
            <field name="active">True</field>
        </record>

        <!-- 
        German TMT Salary Structure Lines:
        - Basic = 50% of (monthly_yearly_costs - bonus_amount)
        - HRA = 40% of Basic
        - Conveyance = 10% of Basic
        - LTA = 10% of Basic
        - Other Allowance = monthly_yearly_costs - bonus_amount - Basic - HRA - Conveyance - LTA
        - TOTAL = Basic + HRA + Conveyance + LTA + Other Allowance
        - Bonus = Fixed 1200 (from bonus_amount field)
        - Payable = TOTAL + Bonus
        - PF SALARY = IF(is_pf_deduct=False, 0, IF((Basic+HRA+Conveyance+LTA)>=15000, 15000, round(Basic+HRA+Conveyance+LTA)))
        - INHAND = Payable - PF SALARY
        -->

        <!-- Basic = 50% of (monthly_yearly_costs - bonus) -->
        <record id="german_tmt_line_basic" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">10</field>
            <field name="name">Basic</field>
            <field name="code">BASIC</field>
            <field name="impact">cost</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">result = (monthly_yearly_costs - bonus) * 0.50</field>
            <field name="show_in_offer">True</field>
        </record>

        <!-- HRA = 40% of Basic -->
        <record id="german_tmt_line_hra" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">20</field>
            <field name="name">HRA</field>
            <field name="code">HRA</field>
            <field name="impact">cost</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">result = amount('BASIC') * 0.40</field>
            <field name="show_in_offer">True</field>
        </record>

        <!-- Conveyance = 10% of Basic -->
        <record id="german_tmt_line_conveyance" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">30</field>
            <field name="name">Conveyance</field>
            <field name="code">CONV</field>
            <field name="impact">cost</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">result = amount('BASIC') * 0.10</field>
            <field name="show_in_offer">True</field>
        </record>

        <!-- LTA = 10% of Basic -->
        <record id="german_tmt_line_lta" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">40</field>
            <field name="name">LTA</field>
            <field name="code">LTA</field>
            <field name="impact">cost</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">result = amount('BASIC') * 0.10</field>
            <field name="show_in_offer">True</field>
        </record>

        <!-- Other Allowance = monthly_yearly_costs - bonus - Basic - HRA - Conveyance - LTA -->
        <record id="german_tmt_line_other_allowance" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">50</field>
            <field name="name">Other Allowance</field>
            <field name="code">OTHER_ALW</field>
            <field name="impact">cost</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">result = (monthly_yearly_costs - bonus) - amount('BASIC') - amount('HRA') - amount('CONV') - amount('LTA')</field>
            <field name="show_in_offer">True</field>
        </record>

        <!-- TOTAL = Basic + HRA + Conveyance + LTA + Other Allowance -->
        <record id="german_tmt_line_total" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">60</field>
            <field name="name">TOTAL</field>
            <field name="code">TOTAL</field>
            <field name="impact">benefit</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">result = amount('BASIC') + amount('HRA') + amount('CONV') + amount('LTA') + amount('OTHER_ALW')</field>
            <field name="show_in_offer">True</field>
        </record>

        <!-- Bonus = Fixed amount from bonus_amount field (default 1200) -->
        <record id="german_tmt_line_bonus" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">70</field>
            <field name="name">Bonus</field>
            <field name="code">BONUS</field>
            <field name="impact">benefit</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">result = bonus</field>
            <field name="show_in_offer">True</field>
        </record>

        <!-- Payable = TOTAL + Bonus -->
        <record id="german_tmt_line_payable" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">80</field>
            <field name="name">Payable</field>
            <field name="code">PAYABLE</field>
            <field name="impact">benefit</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">result = amount('TOTAL') + amount('BONUS')</field>
            <field name="show_in_offer">True</field>
        </record>

        <!-- PF SALARY: IF(is_pf_deduct=False, 0, IF((Basic+HRA+Conveyance+LTA)>=15000, 15000, round(Basic+HRA+Conveyance+LTA))) -->
        <record id="german_tmt_line_pf_salary" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">90</field>
            <field name="name">PF Salary</field>
            <field name="code">PF_SALARY</field>
            <field name="impact">deduction</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">
# PF calculation based on is_pf_deduct flag
# Formula: IF(is_pf_deduct=False, 0, IF((Basic+HRA+Conv+LTA)>=15000, 15000, round(Basic+HRA+Conv+LTA)))
pf_base = amount('BASIC') + amount('HRA') + amount('CONV') + amount('LTA')
if not is_pf_deduct:
    result = 0.0
elif pf_base >= 15000:
    result = 15000.0
else:
    result = round(pf_base)
            </field>
            <field name="show_in_offer">True</field>
        </record>

        <!-- INHAND = Payable - (12% of PF Salary) -->
        <record id="german_tmt_line_inhand" model="salary.config.structure.line">
            <field name="structure_id" ref="german_tmt_salary_structure"/>
            <field name="sequence">100</field>
            <field name="name">In Hand Salary</field>
            <field name="code">INHAND</field>
            <field name="impact">benefit</field>
            <field name="compute_mode">formula</field>
            <field name="python_code">result = amount('PAYABLE') - (amount('PF_SALARY') * 0.12)</field>
            <field name="show_in_offer">True</field>
        </record>

    </data>
</odoo>
